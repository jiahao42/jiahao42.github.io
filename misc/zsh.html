
    <!DOCTYPE html>
    <html>
    <head>
    <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    table td, table td * {
      vertical-align: top;
    }
    th, td {
      padding: 5px;
      text-align: left;
    }
    </style>
    </head>
    <body>
    
    <center><h2>Testcases</h2></center>
    <table style="width:100%">
    <tr><th>Testcases</th>
    <th>Testcase 0</th><th>Testcase 1</th><th>Testcase 2</th><th>Testcase 3</th><th>Testcase 4</th><th>Testcase 5</th><th>Testcase 6</th><th>Testcase 7</th><th>Testcase 8</th><th>Testcase 9</th><th>Testcase 10</th><th>Testcase 11</th></tr><tr><td>Input</td><td>http://www.google.com/webmasters/tools/sitemap-list?hl=en&siteUrl=https://jiahao-cai.info/#MAIN_TAB=0&CARD_TAB=-1</td><td>http://www.example.com/index.php?username=1'%20or%20'1'%20=%20'1&password=1'%20or%20'1'%20=%20'1</td><td>SouthPark-Chatbot/../SouthPark-Chatbot/../SouthPark-Chatbot/src/__pycache__</td><td>./../.././../../../../../..</td><td>http://sisuva.admin.virginia.edu/psc/ihprd/UVSS/SA/s/WEBLIB_PTBR.ISCRIPT1.FieldFormula.IScript_StartPage?URL=https%3A%2F%2Fsisuva.admin.virginia.edu%2Fpsp%2Fihprd%2FUVSS%2FSA%2Fh%2F%3Ftab%3DPAPP_GUEST</td><td>http://www.dealmoon.com/exec/j/?spId=3313583&d=1353122&type=deal&s=iphone&url=https://click.linksynergy.com/deeplink?u1%3Dno_refer%26id%3DJv*v1/Wldzg%26mid%3D3184%26murl%3Dhttps%253A%252F%252Fwww.macys.com%252Fshop%252Fproduct%252Fbella-13973-5-qt.-programmable-polished-stainless-steel-slow-cooker%253FID%253D929040&rip_position=1&rip=search_list&rip_value=%E6%85%A2%E7%82%96%E9%94%85&click_page=deal_detail&editionId=9.6.6&adid=500fb88e19ea7bc94d79769d9cc248d6&lang=cn&udid=F0BB8E1F-7677-4F0C-9506-A7B090DA32BC&platform=iphone#L10</td><td>http://www.google.com/search?ei=tixTXN_ADMbetQXA5IiYBw&q=%253d+url&oq=precentage+in+url&gs_l=psy-ab.3.0.0i71l8.0.0..70859...0.0..0.0.0.......0......gws-wiz.0lw5QrT8uLg</td><td>http://127.0.0.1:4000/mirror/CTAN/macros/latex/contrib/fancyhdr/fancyhdr.pdf</td><td>/Users/james/Applications/Chrome_Apps.localized/Default_bhmicilclplefnflapjmnngmkkkkpfad.app/Contents/Resources/en-CN.lproj</td><td>/home/jiahao/llvm/src/../../..</td><td>/home/jiahao/llvm/src/..///////</td><td>~/Downloads/Once\ Upon\ A\ Time\ In\ America\ \(1984\)</td></tr><tr><td>Output</td><td>/http:/www.google.com/webmasters/tools/sitemap-list?hl=en&siteUrl=https:/jiahao-cai.info/#MAIN_TAB=0&CARD_TAB=-1</td><td>/http:/www.example.com/index.php?username=1'%20or%20'1'%20=%20'1&password=1'%20or%20'1'%20=%20'1</td><td>/SouthPark-Chatbot/src/__pycache__</td><td></td><td>/http:/sisuva.admin.virginia.edu/psc/ihprd/UVSS/SA/s/WEBLIB_PTBR.ISCRIPT1.FieldFormula.IScript_StartPage?URL=https%3A%2F%2Fsisuva.admin.virginia.edu%2Fpsp%2Fihprd%2FUVSS%2FSA%2Fh%2F%3Ftab%3DPAPP_GUEST</td><td></td><td>/http:/www.google.com/search?ei=tixTXN_ADMbetQXA5IiYBw&q=%253d+url&oq=precentage+in+url&gs_l=psy-ab.3.0.0i71l8.0.0..70859...0.0..0.0.0.......0......gws-wiz.0lw5QrT8uLg</td><td>/http:/127.0.0.1:4000/mirror/CTAN/macros/latex/contrib/fancyhdr/fancyhdr.pdf</td><td>//Users/james/Applications/Chrome_Apps.localized/Default_bhmicilclplefnflapjmnngmkkkkpfad.app/Contents/Resources/en-CN.lproj</td><td>//home</td><td>//home/jiahao/llvm</td><td>/~/Downloads/Once</td></tr></table>
    <center><h2>Signature analysis</h2></center>
    <table style="width:100%">
      <tr>
        <th>Source code</th>
    <th>Signature 0</th><th>Signature 1</th><th>Signature 2</th><th>Signature 3</th><th>Signature 4</th><th>Signature 5</th><th>Signature 6</th><th>Signature 7</th><th>Signature 8</th><th>Signature 9</th><th>Signature 10</th><th>Signature 11</th></tr><tr><td>1: #include&nbsp;&quot;stdio.h&quot;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>2: #include&nbsp;&quot;stdlib.h&quot;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>3: #include&nbsp;&quot;string.h&quot;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>4: #include&nbsp;&lt;unistd.h&gt;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>5: #include&nbsp;&quot;zsh.h&quot;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>6: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>7: int&nbsp;my_full&nbsp;=&nbsp;0;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>8: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>9: static&nbsp;char&nbsp;xbuf[PATH_MAX&nbsp;*&nbsp;2&nbsp;+&nbsp;1];</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>10: /*&nbsp;expands&nbsp;symlinks&nbsp;and&nbsp;..&nbsp;or&nbsp;.&nbsp;expressions&nbsp;*/</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>11: static&nbsp;int&nbsp;xsymlinks(char&nbsp;*s,&nbsp;int&nbsp;full)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>12: &nbsp;&nbsp;char&nbsp;**pp,&nbsp;**opp;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>13: &nbsp;&nbsp;char&nbsp;xbuf2[PATH_MAX&nbsp;*&nbsp;3&nbsp;+&nbsp;1],&nbsp;xbuf3[PATH_MAX&nbsp;*&nbsp;2&nbsp;+&nbsp;1];</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>14: &nbsp;&nbsp;int&nbsp;t0,&nbsp;ret&nbsp;=&nbsp;0;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>15: &nbsp;&nbsp;zulong&nbsp;xbuflen&nbsp;=&nbsp;strlen(xbuf),&nbsp;pplen;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>16: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>17: &nbsp;&nbsp;opp&nbsp;=&nbsp;pp&nbsp;=&nbsp;slashsplit(s);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>18: &nbsp;&nbsp;for&nbsp;(;&nbsp;xbuflen&nbsp;&lt;&nbsp;sizeof(xbuf)&nbsp;&amp;&amp;&nbsp;*pp&nbsp;&amp;&amp;&nbsp;ret&nbsp;&gt;=&nbsp;0;&nbsp;pp++)&nbsp;{</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td></tr><tr><td>19: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!strcmp(*pp,&nbsp;&quot;.&quot;))</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td></tr><tr><td>20: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>21: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!strcmp(*pp,&nbsp;&quot;..&quot;))&nbsp;{</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td><td>finding '.'</td></tr><tr><td>22: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;*p;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>23: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>24: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!strcmp(xbuf,&nbsp;&quot;/&quot;))</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>25: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>26: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!*xbuf)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>27: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>28: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;xbuf&nbsp;+&nbsp;xbuflen;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>29: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(*--p&nbsp;!=&nbsp;&#x27;/&#x27;)</td><td></td><td></td><td>finding '/'</td><td></td><td></td><td></td><td></td><td></td><td></td><td>finding '/'</td><td>finding '/'</td><td></td></tr><tr><td>30: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xbuflen--;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>31: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*p&nbsp;=&nbsp;&#x27;\0&#x27;;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>32: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;The&nbsp;\0&nbsp;isn&#x27;t&nbsp;included&nbsp;in&nbsp;the&nbsp;length&nbsp;*/</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>33: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xbuflen--;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>34: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>35: &nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>36: &nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;Includes&nbsp;null&nbsp;byte.&nbsp;*/</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>37: &nbsp;&nbsp;&nbsp;&nbsp;pplen&nbsp;=&nbsp;strlen(*pp)&nbsp;+&nbsp;1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>38: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(xbuflen&nbsp;+&nbsp;pplen&nbsp;+&nbsp;1&nbsp;&gt;&nbsp;sizeof(xbuf2))&nbsp;{</td><td>finding 769</td><td>finding 769</td><td>finding 769</td><td></td><td>finding 769</td><td>finding 769</td><td>finding 769</td><td>finding 769</td><td>finding 769</td><td>finding 769</td><td>finding 769</td><td>finding 769</td></tr><tr><td>39: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*xbuf&nbsp;=&nbsp;0;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>40: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;-1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>41: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>42: &nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>43: &nbsp;&nbsp;&nbsp;&nbsp;memcpy(xbuf2,&nbsp;xbuf,&nbsp;xbuflen);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>44: &nbsp;&nbsp;&nbsp;&nbsp;xbuf2[xbuflen]&nbsp;=&nbsp;&#x27;/&#x27;;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>45: &nbsp;&nbsp;&nbsp;&nbsp;memcpy(xbuf2&nbsp;+&nbsp;xbuflen&nbsp;+&nbsp;1,&nbsp;*pp,&nbsp;pplen);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>46: &nbsp;&nbsp;&nbsp;&nbsp;t0&nbsp;=&nbsp;readlink(unmeta(xbuf2),&nbsp;xbuf3,&nbsp;PATH_MAX);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>47: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(t0&nbsp;==&nbsp;-1)&nbsp;{</td><td>finding -1</td><td>finding -1</td><td>finding -1</td><td></td><td>finding -1</td><td>finding -1</td><td>finding -1</td><td>finding -1</td><td>finding -1</td><td>finding -1</td><td>finding -1</td><td>finding -1</td></tr><tr><td>48: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((xbuflen&nbsp;+=&nbsp;pplen)&nbsp;&lt;&nbsp;sizeof(xbuf))&nbsp;{</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td></td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td><td>finding 513</td></tr><tr><td>49: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcat(xbuf,&nbsp;&quot;/&quot;);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>50: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcat(xbuf,&nbsp;*pp);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>51: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>52: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*xbuf&nbsp;=&nbsp;0;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>53: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;-1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>54: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>55: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>56: &nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>57: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>58: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metafy(xbuf3,&nbsp;t0,&nbsp;META_NOALLOC);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>59: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!full)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>60: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>61: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;If&nbsp;only&nbsp;one&nbsp;expansion&nbsp;requested,&nbsp;ensure&nbsp;the</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>62: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;full&nbsp;path&nbsp;is&nbsp;in&nbsp;xbuf.</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>63: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>64: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zulong&nbsp;len&nbsp;=&nbsp;xbuflen;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>65: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(*xbuf3&nbsp;==&nbsp;&#x27;/&#x27;)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>66: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(xbuf,&nbsp;xbuf3);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>67: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;((len&nbsp;+=&nbsp;strlen(xbuf3)&nbsp;+&nbsp;1)&nbsp;&lt;&nbsp;sizeof(xbuf))&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>68: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(xbuf&nbsp;+&nbsp;xbuflen,&nbsp;&quot;/&quot;);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>69: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(xbuf&nbsp;+&nbsp;xbuflen&nbsp;+&nbsp;1,&nbsp;xbuf3);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>70: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>71: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*xbuf&nbsp;=&nbsp;0;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>72: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;-1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>73: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>74: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>75: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(*++pp)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>76: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zulong&nbsp;newlen&nbsp;=&nbsp;len&nbsp;+&nbsp;strlen(*pp)&nbsp;+&nbsp;1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>77: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(newlen&nbsp;&lt;&nbsp;sizeof(xbuf))&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>78: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(xbuf&nbsp;+&nbsp;len,&nbsp;&quot;/&quot;);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>79: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(xbuf&nbsp;+&nbsp;len&nbsp;+&nbsp;1,&nbsp;*pp);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>80: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;newlen;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>81: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>82: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*xbuf&nbsp;=&nbsp;01;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>83: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;-1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>84: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>85: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>86: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>87: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>88: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;No&nbsp;need&nbsp;to&nbsp;update&nbsp;xbuflen,&nbsp;we&#x27;re&nbsp;finished</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>89: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;expansion&nbsp;(for&nbsp;now).</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>90: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>91: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>92: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>93: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(*xbuf3&nbsp;==&nbsp;&#x27;/&#x27;)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>94: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy(xbuf,&nbsp;&quot;&quot;);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>95: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(xsymlinks(xbuf3&nbsp;+&nbsp;1,&nbsp;1)&nbsp;&lt;&nbsp;0)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>96: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;-1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>97: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>98: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xbuflen&nbsp;=&nbsp;strlen(xbuf);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>99: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(xsymlinks(xbuf3,&nbsp;1)&nbsp;&lt;&nbsp;0)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>100: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;-1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>101: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>102: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xbuflen&nbsp;=&nbsp;strlen(xbuf);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>103: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>104: &nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>105: &nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>106: &nbsp;&nbsp;freearray(opp);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>107: &nbsp;&nbsp;return&nbsp;ret;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>108: }</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>109: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>110: /**/</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>111: static&nbsp;char&nbsp;**slashsplit(char&nbsp;*s)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>112: &nbsp;&nbsp;char&nbsp;*t,&nbsp;**r,&nbsp;**q;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>113: &nbsp;&nbsp;int&nbsp;t0;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>114: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>115: &nbsp;&nbsp;if&nbsp;(!*s)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>116: &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(char&nbsp;**)zshcalloc(sizeof(char&nbsp;*));</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>117: &nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>118: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>119: &nbsp;&nbsp;for&nbsp;(t&nbsp;=&nbsp;s,&nbsp;t0&nbsp;=&nbsp;0;&nbsp;*t;&nbsp;t++)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>120: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(*t&nbsp;==&nbsp;&#x27;/&#x27;)</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td></tr><tr><td>121: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t0++;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>122: &nbsp;&nbsp;q&nbsp;=&nbsp;r&nbsp;=&nbsp;(char&nbsp;**)zalloc(sizeof(char&nbsp;*)&nbsp;*&nbsp;(t0&nbsp;+&nbsp;2));</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>123: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>124: &nbsp;&nbsp;while&nbsp;((t&nbsp;=&nbsp;strchr(s,&nbsp;&#x27;/&#x27;)))&nbsp;{</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td></tr><tr><td>125: &nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;k&nbsp;=&nbsp;t&nbsp;-&nbsp;s;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>126: &nbsp;&nbsp;&nbsp;&nbsp;*q++&nbsp;=&nbsp;ztrduppfx(s,&nbsp;k);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>127: &nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(*t&nbsp;==&nbsp;&#x27;/&#x27;)</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td><td>finding '/'</td></tr><tr><td>128: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t++;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>129: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!*t)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>130: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*q&nbsp;=&nbsp;NULL;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>131: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;r;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>132: &nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>133: &nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;t;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>134: &nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>135: &nbsp;&nbsp;*q++&nbsp;=&nbsp;ztrdup(s);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>136: &nbsp;&nbsp;*q&nbsp;=&nbsp;NULL;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>137: &nbsp;&nbsp;return&nbsp;r;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>138: }</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>139: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>140: /**/</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>141: mod_export&nbsp;char&nbsp;*unmeta(const&nbsp;char&nbsp;*file_name)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>142: &nbsp;&nbsp;static&nbsp;char&nbsp;*fn;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>143: &nbsp;&nbsp;static&nbsp;int&nbsp;sz;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>144: &nbsp;&nbsp;char&nbsp;*p;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>145: &nbsp;&nbsp;const&nbsp;char&nbsp;*t;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>146: &nbsp;&nbsp;int&nbsp;newsz,&nbsp;meta;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>147: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>148: &nbsp;&nbsp;if&nbsp;(!file_name)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>149: &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NULL;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>150: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>151: &nbsp;&nbsp;meta&nbsp;=&nbsp;0;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>152: &nbsp;&nbsp;for&nbsp;(t&nbsp;=&nbsp;file_name;&nbsp;*t;&nbsp;t++)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>153: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(*t&nbsp;==&nbsp;Meta)</td><td>finding -125</td><td>finding -125</td><td>finding -125</td><td></td><td>finding -125</td><td>finding -125</td><td>finding -125</td><td>finding -125</td><td>finding -125</td><td>finding -125</td><td>finding -125</td><td>finding -125</td></tr><tr><td>154: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meta&nbsp;=&nbsp;1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>155: &nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>156: &nbsp;&nbsp;if&nbsp;(!meta)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>157: &nbsp;&nbsp;&nbsp;&nbsp;/*</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>158: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;don&#x27;t&nbsp;need&nbsp;allocation...&nbsp;free&nbsp;if&nbsp;it&#x27;s&nbsp;long,&nbsp;see&nbsp;below</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>159: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>160: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(sz&nbsp;&gt;&nbsp;4&nbsp;*&nbsp;PATH_MAX)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>161: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zfree(fn,&nbsp;sz);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>162: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fn&nbsp;=&nbsp;NULL;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>163: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sz&nbsp;=&nbsp;0;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>164: &nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>165: &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(char&nbsp;*)file_name;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>166: &nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>167: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>168: &nbsp;&nbsp;newsz&nbsp;=&nbsp;(t&nbsp;-&nbsp;file_name)&nbsp;+&nbsp;1;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>169: &nbsp;&nbsp;if&nbsp;(!fn&nbsp;||&nbsp;newsz&nbsp;&gt;&nbsp;sz&nbsp;||&nbsp;(sz&nbsp;&gt;&nbsp;4&nbsp;*&nbsp;PATH_MAX&nbsp;&amp;&amp;&nbsp;newsz&nbsp;&lt;=&nbsp;4&nbsp;*&nbsp;PATH_MAX))&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>170: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(fn)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>171: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zfree(fn,&nbsp;sz);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>172: &nbsp;&nbsp;&nbsp;&nbsp;sz&nbsp;=&nbsp;newsz;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>173: &nbsp;&nbsp;&nbsp;&nbsp;fn&nbsp;=&nbsp;(char&nbsp;*)zalloc(sz);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>174: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!fn)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>175: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sz&nbsp;=&nbsp;0;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>176: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>177: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;will&nbsp;quite&nbsp;likely&nbsp;crash&nbsp;in&nbsp;the&nbsp;caller&nbsp;anyway...</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>178: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>179: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NULL;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>180: &nbsp;&nbsp;&nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>181: &nbsp;&nbsp;}</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>182: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>183: &nbsp;&nbsp;for&nbsp;(t&nbsp;=&nbsp;file_name,&nbsp;p&nbsp;=&nbsp;fn;&nbsp;*t;&nbsp;p++)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>184: &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((*p&nbsp;=&nbsp;*t++)&nbsp;==&nbsp;Meta&nbsp;&amp;&amp;&nbsp;*t)</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>185: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*p&nbsp;=&nbsp;*t++&nbsp;^&nbsp;32;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>186: &nbsp;&nbsp;*p&nbsp;=&nbsp;&#x27;\0&#x27;;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>187: &nbsp;&nbsp;return&nbsp;fn;</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>188: }</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>189: </td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>190: int&nbsp;main(int&nbsp;argc,&nbsp;char&nbsp;**argv)&nbsp;{</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>191: &nbsp;&nbsp;my_init(argc);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>192: &nbsp;&nbsp;xsymlinks(argv[1],&nbsp;my_full);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>193: &nbsp;&nbsp;printf(&quot;%s\n&quot;,&nbsp;xbuf);</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>194: }</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
    </table>
    </body>
    </html>
    