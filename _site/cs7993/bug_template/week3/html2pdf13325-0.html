<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Writeup for phase 1</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../../style.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Writeup for phase 1</h1>
<p class="date">Oct 5, 2018</p>
</header>
<ul>
<li><h5 id="extract-python-code-from-pdf-file-according-to-the-hint-from-the-suffix-of-my-resume-.py.pdf.">1. Extract Python code from pdf file, according to the hint from the suffix of my resume (.py.pdf).</h5></li>
<li><h5 id="try-to-print-the-type-of-everything-to-get-some-hints-e.g.">2. Try to print the type of everything to get some hints, e.g.</h5>
<ul>
<li>code object</li>
<li>the filename is called <code>russian_doll.py</code></li>
</ul></li>
<li><h5 id="start-to-know-marshall-module-try-to-use-if-i-can-get-source-code-from-it.">3. Start to know <code>marshall</code> module, try to use if I can get source code from it.</h5></li>
<li><h5 id="try-to-save-the-decompressed-content-as-.zip-and-unzip-it.-then-realize-it-is-endless-it-corresponds-to-the-name-russian_doll.py.">4. Try to save the decompressed content as <code>.zip</code>, and unzip it. Then realize it is endless, it corresponds to the name <code>russian_doll.py</code>.</h5></li>
<li><h5 id="drag-zip-file-into-text-editor-realize-it-is-a-python-file-indeed-realize-that-this-is-the-file-which-will-be-executed-later.">5. Drag zip file into text editor, realize it is a Python file indeed, realize that this is the file which will be executed later.</h5></li>
<li><h5 id="add-exception-to-see-that-what-really-happened.-it-turns-out-that-it-will-do-something-to-get-the-correct-marshall-data-according-to-the-input.-then-i-realize-what-the-hint-means-the-first-input-should-be-n.">6. Add exception to see that what really happened. It turns out that it will do something to get the correct marshall data according to the input. Then I realize what the hint means, the first input should be <code>n</code>.</h5>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="cf">try</span>:</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">    c1(x, y)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="cf">except</span> <span class="pp">Exception</span>, e:</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="bu">print</span> <span class="st">&quot;Exception: &quot;</span> <span class="op">+</span> <span class="bu">str</span>(e)</a></code></pre></div></li>
<li><h5 id="print-more-things-to-see-what-happened-then-realize-what-happened-the-length-of-the-answer-should-be-13.">7. Print more things to see what happened, then realize what happened, the length of the answer should be 13.</h5>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">def</span> c1(x, y):</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">    <span class="bu">print</span> <span class="st">&quot;New c1...&quot;</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">    <span class="bu">eval</span>(marshal.loads(x))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    <span class="bu">print</span> base64.b64decode(y) <span class="co"># Bunch of encrypted code </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    <span class="bu">exec</span> base64.b64decode(y)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    <span class="bu">print</span> <span class="st">&#39;-&#39;</span> <span class="op">*</span> <span class="dv">77</span></a></code></pre></div></li>
<li><h5 id="try-to-search-for-disassembler-for-marshall-object-then-i-found-dis.-try-to-disassemble-the-code-object-in-the-source-code.">8. Try to search for disassembler for marshall object, then I found dis. Try to disassemble the code object in the source code.</h5></li>
<li><h5 id="first-i-disassembled-x_func-which-you-can-see-it-here-important-thing-is-there-is-a-time-interval-check-which-is-very-interesting.">9. First I disassembled <code>x_func()</code>, which you can see it here, important thing is there is a time interval check, which is very interesting.</h5>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb3-1" data-line-number="1">(Pdb) p x.co_varnames</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">(<span class="st">&#39;message&#39;</span>, <span class="st">&#39;split_string&#39;</span>, <span class="st">&#39;t0&#39;</span>, <span class="st">&#39;fd&#39;</span>, <span class="st">&#39;old_settings&#39;</span>, <span class="st">&#39;res&#39;</span>, <span class="st">&#39;t1&#39;</span>, <span class="st">&#39;x&#39;</span>, <span class="st">&#39;_&#39;</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">(Pdb) p x.co_consts</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">(<span class="va">None</span>, <span class="st">&#39;:R:&#39;</span>, <span class="dv">1</span>, <span class="st">&#39;&#39;</span>, <span class="op">&lt;</span>code <span class="bu">object</span> <span class="op">&lt;</span><span class="kw">lambda</span><span class="op">&gt;</span> at <span class="bn">0x100a712b0</span>, <span class="bu">file</span> <span class="st">&quot;/usr/local/bin/russian_doll.py&quot;</span>, line <span class="dv">44</span><span class="op">&gt;</span>, <span class="dv">4</span>, <span class="op">&lt;</span>code <span class="bu">object</span> <span class="op">&lt;</span><span class="kw">lambda</span><span class="op">&gt;</span> at <span class="bn">0x101804030</span>, <span class="bu">file</span> <span class="st">&quot;/usr/local/bin/russian_doll.py&quot;</span>, line <span class="dv">47</span><span class="op">&gt;</span>, <span class="st">&#39;finished&#39;</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">(Pdb) p x.co_cellvars</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">(<span class="st">&#39;passphrase&#39;</span>,)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="dv">34</span>           <span class="dv">0</span> LOAD_CONST               <span class="dv">1</span> (<span class="st">&#39;:R:&#39;</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">              <span class="dv">3</span> STORE_FAST               <span class="dv">1</span> (split_string)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="dv">36</span>           <span class="dv">6</span> LOAD_GLOBAL              <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">              <span class="dv">9</span> LOAD_ATTR                <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">            <span class="dv">12</span> CALL_FUNCTION            <span class="dv">0</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">            <span class="dv">15</span> STORE_FAST               <span class="dv">2</span> (t0)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="dv">37</span>          <span class="dv">18</span> LOAD_GLOBAL              <span class="dv">1</span> (sys)</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">            <span class="dv">21</span> LOAD_ATTR                <span class="dv">2</span> (stdin)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">            <span class="dv">24</span> LOAD_ATTR                <span class="dv">3</span> (fileno)</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">            <span class="dv">27</span> CALL_FUNCTION            <span class="dv">0</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19">            <span class="dv">30</span> STORE_FAST               <span class="dv">3</span> (fd)</a>
<a class="sourceLine" id="cb3-20" data-line-number="20"></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="dv">38</span>          <span class="dv">33</span> LOAD_GLOBAL              <span class="dv">4</span> (termios)</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">            <span class="dv">36</span> LOAD_ATTR                <span class="dv">5</span> (tcgetattr)</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">            <span class="dv">39</span> LOAD_FAST                <span class="dv">3</span> (fd)</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">            <span class="dv">42</span> CALL_FUNCTION            <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25">            <span class="dv">45</span> STORE_FAST               <span class="dv">4</span> (old_settings)</a>
<a class="sourceLine" id="cb3-26" data-line-number="26"></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="dv">39</span>          <span class="dv">48</span> LOAD_GLOBAL              <span class="dv">6</span> (tty)</a>
<a class="sourceLine" id="cb3-28" data-line-number="28">            <span class="dv">51</span> LOAD_ATTR                <span class="dv">7</span> (setraw)</a>
<a class="sourceLine" id="cb3-29" data-line-number="29">            <span class="dv">54</span> LOAD_GLOBAL              <span class="dv">1</span> (sys)</a>
<a class="sourceLine" id="cb3-30" data-line-number="30">            <span class="dv">57</span> LOAD_ATTR                <span class="dv">2</span> (stdin)</a>
<a class="sourceLine" id="cb3-31" data-line-number="31">            <span class="dv">60</span> LOAD_ATTR                <span class="dv">3</span> (fileno)</a>
<a class="sourceLine" id="cb3-32" data-line-number="32">            <span class="dv">63</span> CALL_FUNCTION            <span class="dv">0</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33">            <span class="dv">66</span> CALL_FUNCTION            <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34">            <span class="dv">69</span> POP_TOP             </a>
<a class="sourceLine" id="cb3-35" data-line-number="35"></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="dv">40</span>          <span class="dv">70</span> LOAD_GLOBAL              <span class="dv">8</span> (<span class="bu">ord</span>)</a>
<a class="sourceLine" id="cb3-37" data-line-number="37">            <span class="dv">73</span> LOAD_GLOBAL              <span class="dv">1</span> (sys)</a>
<a class="sourceLine" id="cb3-38" data-line-number="38">            <span class="dv">76</span> LOAD_ATTR                <span class="dv">2</span> (stdin)</a>
<a class="sourceLine" id="cb3-39" data-line-number="39">            <span class="dv">79</span> LOAD_ATTR                <span class="dv">9</span> (read)</a>
<a class="sourceLine" id="cb3-40" data-line-number="40">            <span class="dv">82</span> LOAD_CONST               <span class="dv">2</span> (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-41" data-line-number="41">            <span class="dv">85</span> CALL_FUNCTION            <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42">            <span class="dv">88</span> CALL_FUNCTION            <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43">            <span class="dv">91</span> STORE_DEREF              <span class="dv">0</span> (passphrase) <span class="co"># passphrase = input</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"></a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="dv">42</span>          <span class="dv">94</span> LOAD_GLOBAL              <span class="dv">4</span> (termios)</a>
<a class="sourceLine" id="cb3-46" data-line-number="46">            <span class="dv">97</span> LOAD_ATTR               <span class="dv">10</span> (tcsetattr)</a>
<a class="sourceLine" id="cb3-47" data-line-number="47">            <span class="dv">100</span> LOAD_FAST                <span class="dv">3</span> (fd)</a>
<a class="sourceLine" id="cb3-48" data-line-number="48">            <span class="dv">103</span> LOAD_GLOBAL              <span class="dv">4</span> (termios)</a>
<a class="sourceLine" id="cb3-49" data-line-number="49">            <span class="dv">106</span> LOAD_ATTR               <span class="dv">11</span> (TCSADRAIN)</a>
<a class="sourceLine" id="cb3-50" data-line-number="50">            <span class="dv">109</span> LOAD_FAST                <span class="dv">4</span> (old_settings)</a>
<a class="sourceLine" id="cb3-51" data-line-number="51">            <span class="dv">112</span> CALL_FUNCTION            <span class="dv">3</span></a>
<a class="sourceLine" id="cb3-52" data-line-number="52">            <span class="dv">115</span> POP_TOP             </a>
<a class="sourceLine" id="cb3-53" data-line-number="53"></a>
<a class="sourceLine" id="cb3-54" data-line-number="54"><span class="dv">44</span>         <span class="dv">116</span> LOAD_CONST               <span class="dv">3</span> (<span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb3-55" data-line-number="55">            <span class="dv">119</span> LOAD_ATTR               <span class="dv">12</span> (join)</a>
<a class="sourceLine" id="cb3-56" data-line-number="56">            <span class="dv">122</span> LOAD_GLOBAL             <span class="dv">13</span> (<span class="bu">map</span>)</a>
<a class="sourceLine" id="cb3-57" data-line-number="57">            <span class="dv">125</span> LOAD_CLOSURE             <span class="dv">0</span> (passphrase)</a>
<a class="sourceLine" id="cb3-58" data-line-number="58">            <span class="dv">128</span> BUILD_TUPLE              <span class="dv">1</span> <span class="co"># (&#39;&#39;.join, map, res)</span></a>
<a class="sourceLine" id="cb3-59" data-line-number="59">            <span class="dv">131</span> LOAD_CONST               <span class="dv">4</span> (<span class="op">&lt;</span>code <span class="bu">object</span> <span class="op">&lt;</span><span class="kw">lambda</span><span class="op">&gt;</span> at <span class="bn">0x10476d7b0</span>, <span class="bu">file</span> <span class="st">&quot;/usr/local/bin/russian_doll.py&quot;</span>, line <span class="dv">44</span><span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb3-60" data-line-number="60">            <span class="co"># TOS is the code, TOS1 the tuple containing cells for the closure’s free variables.</span></a>
<a class="sourceLine" id="cb3-61" data-line-number="61">            <span class="dv">134</span> MAKE_CLOSURE             <span class="dv">0</span> </a>
<a class="sourceLine" id="cb3-62" data-line-number="62">            <span class="dv">137</span> LOAD_FAST                <span class="dv">0</span> (message)</a>
<a class="sourceLine" id="cb3-63" data-line-number="63">            <span class="dv">140</span> CALL_FUNCTION            <span class="dv">2</span></a>
<a class="sourceLine" id="cb3-64" data-line-number="64">            <span class="dv">143</span> CALL_FUNCTION            <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-65" data-line-number="65">            <span class="dv">146</span> STORE_FAST               <span class="dv">5</span> (res) <span class="co"># &#39;c&#39;</span></a>
<a class="sourceLine" id="cb3-66" data-line-number="66"></a>
<a class="sourceLine" id="cb3-67" data-line-number="67"><span class="dv">45</span>         <span class="dv">149</span> LOAD_GLOBAL              <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb3-68" data-line-number="68">            <span class="dv">152</span> LOAD_ATTR                <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb3-69" data-line-number="69">            <span class="dv">155</span> CALL_FUNCTION            <span class="dv">0</span></a>
<a class="sourceLine" id="cb3-70" data-line-number="70">            <span class="dv">158</span> STORE_FAST               <span class="dv">6</span> (t1) <span class="co"># t1 = now()</span></a>
<a class="sourceLine" id="cb3-71" data-line-number="71"></a>
<a class="sourceLine" id="cb3-72" data-line-number="72"><span class="dv">46</span>         <span class="dv">161</span> LOAD_FAST                <span class="dv">6</span> (t1)</a>
<a class="sourceLine" id="cb3-73" data-line-number="73">            <span class="dv">164</span> LOAD_FAST                <span class="dv">2</span> (t0)</a>
<a class="sourceLine" id="cb3-74" data-line-number="74">            <span class="dv">167</span> BINARY_SUBTRACT                 <span class="co"># t = t1 - t2</span></a>
<a class="sourceLine" id="cb3-75" data-line-number="75">            <span class="dv">168</span> LOAD_CONST               <span class="dv">5</span> (<span class="dv">4</span>)  <span class="co"># t &gt; 4</span></a>
<a class="sourceLine" id="cb3-76" data-line-number="76">            <span class="dv">171</span> COMPARE_OP               <span class="dv">4</span> (<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb3-77" data-line-number="77">            <span class="dv">174</span> POP_JUMP_IF_FALSE      <span class="dv">213</span>      <span class="co"># if (t &lt; 4) goto wrong</span></a>
<a class="sourceLine" id="cb3-78" data-line-number="78"></a>
<a class="sourceLine" id="cb3-79" data-line-number="79"><span class="dv">47</span>         <span class="dv">177</span> LOAD_CONST               <span class="dv">3</span> (<span class="st">&#39;&#39;</span>)</a>
<a class="sourceLine" id="cb3-80" data-line-number="80">            <span class="dv">180</span> LOAD_ATTR               <span class="dv">12</span> (join)</a>
<a class="sourceLine" id="cb3-81" data-line-number="81">            <span class="dv">183</span> LOAD_GLOBAL             <span class="dv">13</span> (<span class="bu">map</span>)</a>
<a class="sourceLine" id="cb3-82" data-line-number="82">            <span class="dv">186</span> LOAD_CLOSURE             <span class="dv">0</span> (passphrase)</a>
<a class="sourceLine" id="cb3-83" data-line-number="83">            <span class="dv">189</span> BUILD_TUPLE              <span class="dv">1</span> <span class="co"># (&#39;&#39;.join.map, passphrase)</span></a>
<a class="sourceLine" id="cb3-84" data-line-number="84">            <span class="dv">192</span> LOAD_CONST               <span class="dv">6</span> (<span class="op">&lt;</span>code <span class="bu">object</span> <span class="op">&lt;</span><span class="kw">lambda</span><span class="op">&gt;</span> at <span class="bn">0x10476d830</span>, <span class="bu">file</span> <span class="st">&quot;/usr/local/bin/russian_doll.py&quot;</span>, line <span class="dv">47</span><span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb3-85" data-line-number="85">            <span class="dv">195</span> MAKE_CLOSURE             <span class="dv">0</span></a>
<a class="sourceLine" id="cb3-86" data-line-number="86">            <span class="dv">198</span> LOAD_FAST                <span class="dv">0</span> (message)</a>
<a class="sourceLine" id="cb3-87" data-line-number="87">            <span class="dv">201</span> CALL_FUNCTION            <span class="dv">2</span></a>
<a class="sourceLine" id="cb3-88" data-line-number="88">            <span class="dv">204</span> CALL_FUNCTION            <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-89" data-line-number="89">            <span class="dv">207</span> STORE_FAST               <span class="dv">5</span> (res)</a>
<a class="sourceLine" id="cb3-90" data-line-number="90">            <span class="dv">210</span> JUMP_FORWARD             <span class="dv">0</span> (to <span class="dv">213</span>)</a>
<a class="sourceLine" id="cb3-91" data-line-number="91"></a>
<a class="sourceLine" id="cb3-92" data-line-number="92"><span class="dv">48</span>     <span class="op">&gt;&gt;</span>  <span class="dv">213</span> LOAD_FAST                <span class="dv">5</span> (res)</a>
<a class="sourceLine" id="cb3-93" data-line-number="93">            <span class="dv">216</span> LOAD_ATTR               <span class="dv">14</span> (split)</a>
<a class="sourceLine" id="cb3-94" data-line-number="94">            <span class="dv">219</span> LOAD_FAST                <span class="dv">1</span> (split_string) <span class="co"># :R:</span></a>
<a class="sourceLine" id="cb3-95" data-line-number="95">            <span class="dv">222</span> CALL_FUNCTION            <span class="dv">1</span>  <span class="co"># x = res.split(&#39;:R:&#39;)</span></a>
<a class="sourceLine" id="cb3-96" data-line-number="96">            <span class="dv">225</span> STORE_FAST               <span class="dv">7</span> (x)</a>
<a class="sourceLine" id="cb3-97" data-line-number="97"></a>
<a class="sourceLine" id="cb3-98" data-line-number="98"><span class="dv">49</span>         <span class="dv">228</span> LOAD_GLOBAL             <span class="dv">15</span> (<span class="bu">len</span>)</a>
<a class="sourceLine" id="cb3-99" data-line-number="99">            <span class="dv">231</span> LOAD_FAST                <span class="dv">7</span> (x)</a>
<a class="sourceLine" id="cb3-100" data-line-number="100">            <span class="dv">234</span> CALL_FUNCTION            <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-101" data-line-number="101">            <span class="dv">237</span> LOAD_CONST               <span class="dv">2</span> (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-102" data-line-number="102">            <span class="dv">240</span> COMPARE_OP               <span class="dv">2</span> (<span class="op">==</span>) <span class="co"># if (len(x) != 1) goto next stage</span></a>
<a class="sourceLine" id="cb3-103" data-line-number="103">            <span class="dv">243</span> POP_JUMP_IF_FALSE      <span class="dv">266</span></a>
<a class="sourceLine" id="cb3-104" data-line-number="104"></a>
<a class="sourceLine" id="cb3-105" data-line-number="105"><span class="dv">50</span>         <span class="dv">246</span> LOAD_CONST               <span class="dv">7</span> (<span class="st">&#39;finished&#39;</span>)</a>
<a class="sourceLine" id="cb3-106" data-line-number="106">            <span class="dv">249</span> STORE_FAST               <span class="dv">8</span> (_)</a>
<a class="sourceLine" id="cb3-107" data-line-number="107"></a>
<a class="sourceLine" id="cb3-108" data-line-number="108"><span class="dv">51</span>         <span class="dv">252</span> LOAD_FAST                <span class="dv">7</span> (x)</a>
<a class="sourceLine" id="cb3-109" data-line-number="109">            <span class="dv">255</span> LOAD_CONST               <span class="dv">8</span> (<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb3-110" data-line-number="110">            <span class="dv">258</span> BINARY_SUBSCR                   <span class="co"># x[0]</span></a>
<a class="sourceLine" id="cb3-111" data-line-number="111">            <span class="dv">259</span> LOAD_FAST                <span class="dv">8</span> (_)  <span class="co"># finished</span></a>
<a class="sourceLine" id="cb3-112" data-line-number="112">            <span class="dv">262</span> BUILD_TUPLE              <span class="dv">2</span>      <span class="co"># (x[0], &#39;finished&#39;)</span></a>
<a class="sourceLine" id="cb3-113" data-line-number="113">            <span class="dv">265</span> RETURN_VALUE                    <span class="co"># current return</span></a>
<a class="sourceLine" id="cb3-114" data-line-number="114"></a>
<a class="sourceLine" id="cb3-115" data-line-number="115"><span class="dv">52</span>     <span class="op">&gt;&gt;</span>  <span class="dv">266</span> LOAD_FAST                <span class="dv">7</span> (x)</a>
<a class="sourceLine" id="cb3-116" data-line-number="116">            <span class="dv">269</span> LOAD_CONST               <span class="dv">8</span> (<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb3-117" data-line-number="117">            <span class="dv">272</span> BINARY_SUBSCR                   <span class="co"># x[0]</span></a>
<a class="sourceLine" id="cb3-118" data-line-number="118">            <span class="dv">273</span> LOAD_FAST                <span class="dv">7</span> (x)</a>
<a class="sourceLine" id="cb3-119" data-line-number="119">            <span class="dv">276</span> LOAD_CONST               <span class="dv">2</span> (<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-120" data-line-number="120">            <span class="dv">279</span> BINARY_SUBSCR                   <span class="co"># x[1]</span></a>
<a class="sourceLine" id="cb3-121" data-line-number="121">            <span class="dv">280</span> BUILD_TUPLE              <span class="dv">2</span>      <span class="co"># (x[0], x[1])</span></a>
<a class="sourceLine" id="cb3-122" data-line-number="122">            <span class="dv">283</span> RETURN_VALUE                    <span class="co"># wrong return</span></a></code></pre></div></li>
<li><h5 id="then-i-add-disassembler-to-c1x-y-in-this-case-everytime-it-use-exec-to-enter-a-new-level-it-will-print-the-disassembly-code-automatically">10. Then I add disassembler to <code>c1(x, y)</code>, in this case, everytime it use <code>exec</code> to enter a new level, it will print the disassembly code automatically:</h5>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">def</span> c1(x, y):</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">    <span class="bu">print</span> <span class="st">&quot;New c1...&quot;</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">    <span class="bu">eval</span>(marshal.loads(x))</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">    <span class="bu">print</span> dis.dis(marshal.loads(x))</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">    <span class="bu">exec</span> base64.b64decode(y)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">    <span class="bu">print</span> <span class="st">&#39;-&#39;</span> <span class="op">*</span> <span class="dv">77</span></a></code></pre></div></li>
<li><h5 id="the-acsii-code-of-the-current-answer-is-hidden-in-the-return-value-of-the-code">11. The ACSII code of the current answer is hidden in the return value of the code</h5>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb5-1" data-line-number="1">  <span class="dv">3</span>           <span class="dv">0</span> LOAD_CONST               <span class="dv">1</span> (<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="dv">6</span>           <span class="dv">3</span> LOAD_CONST               <span class="dv">0</span> (<span class="va">None</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="dv">9</span>           <span class="dv">6</span> IMPORT_NAME              <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="dv">12</span>           <span class="dv">9</span> STORE_FAST               <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="dv">15</span>          <span class="dv">12</span> LOAD_CONST               <span class="dv">1</span> (<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="dv">18</span>          <span class="dv">15</span> LOAD_CONST               <span class="dv">0</span> (<span class="va">None</span>)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="dv">21</span>          <span class="dv">18</span> IMPORT_NAME              <span class="dv">1</span> (os)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="dv">24</span>          <span class="dv">21</span> STORE_FAST               <span class="dv">1</span> (os)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="dv">27</span>          <span class="dv">24</span> LOAD_FAST                <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="dv">30</span>          <span class="dv">27</span> LOAD_ATTR                <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="dv">33</span>          <span class="dv">30</span> CALL_FUNCTION            <span class="dv">0</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="dv">36</span>          <span class="dv">33</span> STORE_FAST               <span class="dv">2</span> (_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="dv">39</span>          <span class="dv">36</span> LOAD_CONST               <span class="dv">2</span> (<span class="fl">1539268928.71756</span>)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="dv">42</span>          <span class="dv">39</span> LOAD_FAST                <span class="dv">2</span> (_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="dv">45</span>          <span class="dv">42</span> BINARY_SUBTRACT     </a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="dv">46</span>          <span class="dv">43</span> STORE_FAST               <span class="dv">3</span> (_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="dv">49</span>          <span class="dv">46</span> LOAD_FAST                <span class="dv">3</span> (_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="dv">52</span>          <span class="dv">49</span> LOAD_CONST               <span class="dv">3</span> (<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="dv">55</span>          <span class="dv">52</span> COMPARE_OP               <span class="dv">0</span> (<span class="op">&lt;</span>)</a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="dv">58</span>          <span class="dv">55</span> DUP_TOP             </a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="dv">59</span>          <span class="dv">56</span> POP_JUMP_IF_TRUE       <span class="dv">113</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="dv">62</span>          <span class="dv">59</span> LOAD_FAST                <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="dv">65</span>          <span class="dv">62</span> LOAD_ATTR                <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="dv">68</span>          <span class="dv">65</span> CALL_FUNCTION            <span class="dv">0</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="dv">71</span>          <span class="dv">68</span> STORE_FAST               <span class="dv">2</span> (_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="dv">74</span>          <span class="dv">71</span> LOAD_FAST                <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="dv">77</span>          <span class="dv">74</span> LOAD_ATTR                <span class="dv">0</span> (time)</a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="dv">80</span>          <span class="dv">77</span> CALL_FUNCTION            <span class="dv">0</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="dv">83</span>          <span class="dv">80</span> STORE_FAST               <span class="dv">4</span> (_<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="dv">86</span>          <span class="dv">83</span> LOAD_FAST                <span class="dv">4</span> (_<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="dv">89</span>          <span class="dv">86</span> LOAD_FAST                <span class="dv">2</span> (_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-32" data-line-number="32"><span class="dv">92</span>          <span class="dv">89</span> BINARY_SUBTRACT     </a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="dv">93</span>          <span class="dv">90</span> STORE_FAST               <span class="dv">3</span> (_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="dv">96</span>          <span class="dv">93</span> LOAD_FAST                <span class="dv">3</span> (_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="dv">99</span>          <span class="dv">96</span> LOAD_CONST               <span class="dv">4</span> (<span class="fl">4.1</span>)</a>
<a class="sourceLine" id="cb5-36" data-line-number="36"><span class="dv">102</span>          <span class="dv">99</span> COMPARE_OP               <span class="dv">4</span> (<span class="op">&gt;</span>)</a>
<a class="sourceLine" id="cb5-37" data-line-number="37"><span class="dv">105</span>         <span class="dv">102</span> DUP_TOP             </a>
<a class="sourceLine" id="cb5-38" data-line-number="38"><span class="dv">106</span>         <span class="dv">103</span> POP_JUMP_IF_TRUE       <span class="dv">110</span></a>
<a class="sourceLine" id="cb5-39" data-line-number="39"><span class="dv">109</span>         <span class="dv">106</span> LOAD_CONST               <span class="dv">5</span> (<span class="dv">118</span>) <span class="co"># Answer to the next level!</span></a>
<a class="sourceLine" id="cb5-40" data-line-number="40"><span class="dv">112</span>         <span class="dv">109</span> RETURN_VALUE        </a>
<a class="sourceLine" id="cb5-41" data-line-number="41"><span class="dv">113</span>     <span class="op">&gt;&gt;</span>  <span class="dv">110</span> JUMP_ABSOLUTE          <span class="dv">110</span></a>
<a class="sourceLine" id="cb5-42" data-line-number="42"><span class="dv">116</span>     <span class="op">&gt;&gt;</span>  <span class="dv">113</span> LOAD_CONST               <span class="dv">6</span> (<span class="st">&#39;too slooooo00w!!&#39;</span>)</a>
<a class="sourceLine" id="cb5-43" data-line-number="43"><span class="dv">119</span>         <span class="dv">116</span> PRINT_ITEM          </a></code></pre></div></li>
<li><h5 id="finally-we-can-get-the-answer">12. Finally we can get the answer:</h5>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">#  n   e    r  v   o  (t) (r) (X) (n) (&quot;) (M) (F) (})</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># 110 101 114 118 111 116 114 89 110  35  77  70  125   </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#                        _^_                                          _^_</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#                       (   )________________________________________(   )</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#                       |   |                                        |   |</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#                       |   |        N                               |   |</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#                       |   |        |                               |   |</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#                       |   |      \   /     N 40&amp;#xb0; 45&#39; 16.984&quot;  |   |</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#                       |   |   W -  o  - E                          |   |</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#                       |   |      /   \     W 73&amp;#xb0; 59&#39; 38.033&quot;  |   |</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#                       |   |        |                               |   |</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#                       |   |        S                               |   |</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#                       (_ _)________________________________________(_ _)</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#                         v                                            v</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co"># Congrutlations! You solved Phase 1 of the problem. Get the phase 2 challenge here: http://www.redballoonsecurity.com/1NPTMESGGL/JFS7BSFB23.tar.gz.gpg . Key to unlock the challenge:&#39;rbssecretcongratz!&#39;. Look in my memory for further instructions. </span></a></code></pre></div></li>
<li><h5 id="use-lldb---attach-pid-pid-to-attach-to-the-process-and-use-process-save-core-core-to-dump-the-memory-and-search-for-the-email-o4yr7w3jo9redballoonsecurity.com.">13. Use <code>lldb --attach-pid [pid]</code> to attach to the process and use <code>process save-core &quot;core&quot;</code> to dump the memory and search for the email: o4yr7w3jo9@redballoonsecurity.com.</h5></li>
</ul>
<p><strong>It is a very interesting program, I have to admit that I didn’t get all the details though I got the answer. When doing this challenge, I can feel that <em>Red Balloon Security</em> must be a very interesing company, and full of the old style hacker atmosphere, that’s really COOL!</strong></p>
<p><strong>-Jiahao</strong></p>
</body>
</html>
